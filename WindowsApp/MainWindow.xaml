<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WindowsApp" 
        xmlns:av="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:md="https://handyorg.github.io/handycontrol" mc:Ignorable="av" x:Class="WindowsApp.MainWindow"                
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:hc="https://handyorg.github.io/handycontrol"   
        Icon="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/icon.png" 
        Title="Reporto"
        ResizeMode="CanResize"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized">
    <Window.Resources>
        <!-- اضافه کردن فونت Gandom -->
        <FontFamily x:Key="GandomFont">/WindowsApp/Fonts/Gandom.ttf</FontFamily>
        <local:PersianDateConverter x:Key="PersianDateConverter"/>
        <local:NatureFinalBalanceConverter x:Key="NatureFinalBalanceConverter"/>
        <local:NumberToThousandsSeparatorConverter x:Key="NumberToThousandsSeparatorConverter" />
        <local:RowNumberConverter x:Key="RowNumberConverter" />
        <local:ChequeLastStateConverter x:Key="ChequeLastStateConverter" />
    </Window.Resources>

    <Grid>
        <!-- تعریف ستون‌ها: ستون اول برای تب‌ها (96%) و ستون دوم برای دکمه‌ها (4%) -->
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="95*"/>
            <ColumnDefinition Width="5*"/>
        </Grid.ColumnDefinitions>

        <!-- ScrollViewer برای تب‌ها به منظور اسکرول کردن در صورت نیاز -->
        <!--<ScrollViewer Grid.Column="0" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">-->
            <TabControl x:Name="MainTabControl" Margin="10" TabStripPlacement="Right" PreviewKeyDown="TabControl_PreviewKeyDown">
                <TabControl.Resources>
                    <Style TargetType="{x:Type TabItem}">
                        <Setter Property="Height" Value="100" />
                    </Style>
                </TabControl.Resources >

                <!-- تب‌ها -->
                <TabItem x:Name="HomeTab" Header="داشبورد" FontFamily="Estedad" FontSize="17" FontWeight="Bold"  Height="50">
                    <Grid Background="White">
                                            
                        <StackPanel>
                            <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/reportologo.jpg" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,100,0,100" Width="400"/>
                            <Label 
                                Content="JSON بارگذاری فایل"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Top"
                                Margin="0,20,0,0"                               
                                Width="200"
                                Height="40"                                 
                                />
                            
                            <Button
                                  
                                x:Name="btnfinrecievedforname1plus"
                                Width="40"
                                Height="40"
                                Margin="0,6"
                                Background="#FFFF9900"
                                BorderBrush="#FFFF9900"
                                Foreground="White"
                                Cursor="Hand" 
                                Style="{DynamicResource ButtonStyle1}" 
                                VerticalAlignment="Center"
                                IsTabStop="False"
                                HorizontalAlignment="Center"
                                Grid.Row="1"
                                Grid.Column="7"
                                Click="LoadJsonFileButton_Click">
                                <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/plus.png" Width="19" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Button>

                    </StackPanel>

                    </Grid>
                </TabItem>

                <TabItem  x:Name="ProjectTab" Header="پروژه‌ها" FontFamily="Estedad" FontSize="17" FontWeight="Bold" Height="50">
                    <Grid Background="White">
                        <TextBlock Text="اطلاعات پروژه‌ها" FontSize="24" Foreground="Black"
                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        <Grid Background="White">
                            <!-- اضافه کردن DataGrid برای نمایش پروژه‌ها -->
                            <DataGrid x:Name="ProjectsDataGrid" 
                                  Margin="10"
                                  AutoGenerateColumns="False"   
                                  HorizontalAlignment="Stretch"
                                  VerticalAlignment="Stretch" 
                                  IsReadOnly="True"
                                  FlowDirection="RightToLeft"
                                  RowHeight="50"
                                  FontSize="16"  
                                  MouseDoubleClick="ProjectsDataGrid_MouseDoubleClick">
                                <DataGrid.Columns>

                                <DataGridTextColumn Header="ردیف" Binding="{Binding RowNumber}" />
                                <!-- ستون Title -->
                                    <DataGridTextColumn Header="عنوان پروژه" Binding="{Binding ContractTitle}" />

                                    <!-- ستون Location -->
                                    <DataGridTextColumn Header="زمان تنظیم قراداد پروژه" Binding="{Binding ContractDate, Converter={StaticResource PersianDateConverter}}" />

                                    <!-- ستون StartDate -->
                                    <DataGridTextColumn Header="نوع پروژه" Binding="{Binding ContractType}" />

                                    <!-- ستون StartDate -->
                                    <DataGridTextColumn Header="متراژ" Binding="{Binding ContractPeriod}" />

                                    <!-- ستون StartDate -->
                                    <DataGridTextColumn Header="تاریخ شروع" Binding="{Binding ContractStartDate, Converter={StaticResource PersianDateConverter}}" />

                                    <!-- ستون StartDate -->
                                    <DataGridTextColumn Header="تاریخ پایان" Binding="{Binding ContractEndDate, Converter={StaticResource PersianDateConverter}}" />

                                 
                                </DataGrid.Columns>
                            </DataGrid>


                        </Grid>
                    </Grid>
                </TabItem>

                <TabItem x:Name="PersonTab" Header="اشخاص" FontFamily="Estedad" FontSize="17" FontWeight="Bold" Height="50">
                    <Grid Background="White"  >
                        <StackPanel Margin="5"  FlowDirection="RightToLeft">
                            <!-- قرار دادن ComboBox داخل یک کادر (با استفاده از Border) -->
                            <Border BorderBrush="Gray" BorderThickness="3"  CornerRadius="7" Height="80" RenderTransformOrigin="0.882,0.56">
                                <DockPanel Margin="10,10,10,20">
                                    <StackPanel>
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left">
                                            <TextBlock x:Name="txtlabelsearchby" Height="32" TextWrapping="Wrap" Width="95" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run Text="F3"/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="گروه اشخاص"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchInPerson"  SelectionChanged="SearchInPerson_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>
                                            <TextBlock x:Name="txtlabelsearchby2"  Height="32" TextWrapping="Wrap" Width="125" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run Text=" F4 نام و نام خانوادگی: "/></TextBlock>
                                            <TextBox x:Name="txtfilterdataPerson" TextChanged="TxtfilterdataPerson_TextChanged" SelectionBrush="#FFFF9900" BorderBrush="#FFC6C7C8" Cursor="IBeam" Style="{DynamicResource TextBoxStyle1}" Padding="3,3,0,0" Grid.Column="1" HorizontalAlignment="Left" Width="192" Grid.Row="2" Margin="0" Height="30" VerticalAlignment="Center" FontFamily="Estedad" FontSize="14" FontWeight="Bold" TabIndex="1" />

                                            <RadioButton  Content="همه" GroupName="TransactionType" x:Name="ALLRadioButton" Width="60"  Checked="RadioButtonPerson_Checked" Margin="5"/>
                                            <RadioButton  Content="بدهکاران" GroupName="TransactionType" x:Name="DebtorRadioButton" Width="90" Checked="RadioButtonPerson_Checked" Margin="5"/>
                                            <RadioButton   Content="بستانکاران" GroupName="TransactionType" x:Name="CreditorRadioButton" Width="90" Checked="RadioButtonPerson_Checked" Margin="5"/>
                                        </StackPanel>
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,6,0,0">
                                        </StackPanel>
                                    </StackPanel>
                                    <!--<Button x:Name="btnfinchekpaymentlistexcel" Margin="7,0,0,0" Background="#FF006CB9" BorderBrush="#FF969696" Foreground="White" FontFamily="Estedad" FontSize="14.667" FontWeight="Light" Style="{DynamicResource ButtonStyle1}" Cursor="Hand" Grid.Column="3" VerticalAlignment="Center" Height="30" IsTabStop="False"  Width="80" HorizontalAlignment="Right" DockPanel.Dock="Bottom">
                                        <TextBlock TextAlignment="Center" FontSize="12" FontWeight="Medium" Text="خروجی اکسل"/>
                                    </Button>-->
                                <Button x:Name="btnPersonDataGridExcel" 
                                      Margin="0,0,0,0" 
                                      Background="white"                                                           
                                      Style="{DynamicResource ButtonStyle1}" 
                                      Cursor="Hand" 
                                      Grid.Column="3" 
                                      VerticalAlignment="Center" 
                                      Height="90" 
                                      IsTabStop="False" 
                                      BorderBrush="White"                                       
                                      Width="60" 
                                      HorizontalAlignment="Right" 
                                      Click="PersonDataGridExcel">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/excel-2.jpg" Width="40" Height="40"  />

                                    </StackPanel>
                                </Button>
                            </DockPanel>

                            </Border>
                        </StackPanel>

                   
                        <!-- DataGrid برای نمایش داده‌ها -->
                        <DataGrid 
                        x:Name="PersonsDataGrid" 
                        Margin="5,90,5,0" 
                        IsReadOnly="True" 
                        FlowDirection="RightToLeft"
                        RowHeight="42" 
                        FontSize="16" 
                        AutoGenerateColumns="False"
                             FontFamily="Estedad"
                            MouseDoubleClick="DataGrid_MouseDoubleClick">

                            <DataGrid.Columns>
                            <!-- ستون شماره ردیف -->
                            <DataGridTextColumn Header="ردیف" Binding="{Binding RowNumber}" />

                            <DataGridTextColumn Header="گروه اشخاص" Binding="{Binding TafziliGroupName}" />
                                <DataGridTextColumn Header="نام و نام خانوادگی" Binding="{Binding TafziliName}" />
                                <DataGridTextColumn Header="بدهکار اول دوره" Binding="{Binding FirstTotalDebtorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بستانکار اول دوره" Binding="{Binding FirstTotalCreditorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بدهکار طی دوره" Binding="{Binding TotalDebtorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بستانکار طی دوره" Binding="{Binding TotalCreditorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="ماهیت" Binding="{Binding NatureFinalBalance, Converter={StaticResource NatureFinalBalanceConverter}}">
                                    <DataGridTextColumn.CellStyle>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <!-- رنگ قرمز برای بدهکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="1">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Red" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ سبز برای بستانکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="2">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Green" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ پیش‌فرض برای بی حساب -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="0">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Black" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGridTextColumn.CellStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="مانده نهایی" Binding="{Binding Finalbalance, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                            </DataGrid.Columns>
                        </DataGrid>
                  

                </Grid>
                </TabItem>


                <TabItem x:Name="BankTab" Header="بانک‌ها" FontFamily="Estedad" FontSize="17" FontWeight="Bold" Height="50">
                    <Grid Background="White">
                        <StackPanel Margin="5"  FlowDirection="RightToLeft">
                            <!-- قرار دادن ComboBox داخل یک کادر (با استفاده از Border) -->
                            <Border BorderBrush="Gray" BorderThickness="3"  CornerRadius="7" Height="80" RenderTransformOrigin="0.882,0.56">
                                <DockPanel Margin="10,10,10,20">
                                    <StackPanel>
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left">
                                            <TextBlock x:Name="txtlabelbanksearchby" Height="32" TextWrapping="Wrap" Width="95" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run Text="F3"/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="گروه بانک ها"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchInbank"  SelectionChanged="SearchInbank_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>
                                            <TextBlock x:Name="txtlabelbanksearchby2"  Height="32" TextWrapping="Wrap" Width="165" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run Text=" F4 نام و شماره حساب بانک: "/></TextBlock>
                                            <TextBox x:Name="txtfilterdatabank" TextChanged="Txtfilterdatabank_TextChanged" SelectionBrush="#FFFF9900" BorderBrush="#FFC6C7C8" Cursor="IBeam" Style="{DynamicResource TextBoxStyle1}" Padding="3,3,0,0" Grid.Column="1" HorizontalAlignment="Left" Width="192" Grid.Row="2" Margin="0" Height="30" VerticalAlignment="Center" FontFamily="Estedad" FontSize="14" FontWeight="Bold" TabIndex="1" />

                                            <RadioButton  Content="همه" GroupName="TransactionType" x:Name="ALLRadioButtonbank" Width="60"  Checked="RadioButtonbank_Checked" Margin="5"/>
                                            <RadioButton  Content="دارای موجودی" GroupName="TransactionType" x:Name="DebtorRadioButtonbank" Width="115" Checked="RadioButtonbank_Checked" Margin="5"/>
                                            <RadioButton   Content="موجودی منفی" GroupName="TransactionType" x:Name="CreditorRadioButtonbank" Width="115" Checked="RadioButtonbank_Checked" Margin="5"/>
                                        </StackPanel>
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,6,0,0">
                                        </StackPanel>
                                    </StackPanel>
                                <Button x:Name="btnBankDataGridExcel" 
                                        Margin="0,0,0,0" 
                                        Background="white"                                                           
                                        Style="{DynamicResource ButtonStyle1}" 
                                        Cursor="Hand" 
                                        Grid.Column="3" 
                                        VerticalAlignment="Center" 
                                        Height="90" 
                                        IsTabStop="False" 
                                        BorderBrush="White"                                       
                                        Width="60" 
                                        HorizontalAlignment="Right" 
                                        Click="BankDataGridExcel">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/excel-2.jpg" Width="40" Height="40"  />

                                    </StackPanel>
                                </Button>
                            </DockPanel>

                            </Border>
                        </StackPanel>



                        <DataGrid x:Name="BanksDataGrid" 
                               Margin="5,90,5,0" 
                              IsReadOnly="True" 
                              FlowDirection="RightToLeft"
                              RowHeight="42" 
                              FontSize="16" 
                              AutoGenerateColumns="False"
                              FontFamily="Estedad"
                              MouseDoubleClick="DataGrid_MouseDoubleClick">
                            <DataGrid.Columns>
                                <!-- ستون شماره ردیف -->
                            <DataGridTextColumn Header="ردیف" Binding="{Binding RowNumber}" />

                                <DataGridTextColumn Header="گروه بانک" Binding="{Binding TafziliGroupName}" />
                                <DataGridTextColumn Header="نام و شماره حساب بانک" Binding="{Binding TafziliName}" />
                                <DataGridTextColumn Header="بدهکار اول دوره" Binding="{Binding FirstTotalDebtorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بستانکار اول دوره" Binding="{Binding FirstTotalCreditorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بدهکار طی دوره" Binding="{Binding TotalDebtorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بستانکار طی دوره" Binding="{Binding TotalCreditorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="ماهیت" Binding="{Binding NatureFinalBalance, Converter={StaticResource NatureFinalBalanceConverter}}">
                                    <DataGridTextColumn.CellStyle>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <!-- رنگ قرمز برای بدهکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="1">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Red" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ سبز برای بستانکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="2">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Green" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ پیش‌فرض برای بی حساب -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="0">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Black" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGridTextColumn.CellStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="مانده نهایی" Binding="{Binding Finalbalance, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                            </DataGrid.Columns>
                        </DataGrid>

                    </Grid>


   
                      
                </TabItem>

                <TabItem x:Name="InstantPaymentTab" Header="تنخواه داران" FontFamily="Estedad" FontSize="17" FontWeight="Bold" Height="50">
                    <Grid Background="White"  >
                        <StackPanel Margin="5"  FlowDirection="RightToLeft">
                            <!-- قرار دادن ComboBox داخل یک کادر (با استفاده از Border) -->
                            <Border BorderBrush="Gray" BorderThickness="3"  CornerRadius="7" Height="80" RenderTransformOrigin="0.882,0.56">
                                <DockPanel Margin="10,10,10,20">
                                    <StackPanel>
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left">
                                            <TextBlock x:Name="txtlabelInstantPaymentsearchby" Height="32" TextWrapping="Wrap" Width="95" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run Text="F3"/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="گروه تنخواه داران"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchInInstantPayment"  SelectionChanged="SearchInInstantPayment_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>
                                            <TextBlock x:Name="txtlabelInstantPaymentsearchby2"  Height="32" TextWrapping="Wrap" Width="100" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run Text=" F4 عنوان تنخواه: "/></TextBlock>
                                            <TextBox x:Name="txtfilterdataInstantPayment" TextChanged="TxtfilterdataInstantPayment_TextChanged" SelectionBrush="#FFFF9900" BorderBrush="#FFC6C7C8" Cursor="IBeam" Style="{DynamicResource TextBoxStyle1}" Padding="3,3,0,0" Grid.Column="1" HorizontalAlignment="Left" Width="192" Grid.Row="2" Margin="0" Height="30" VerticalAlignment="Center" FontFamily="Estedad" FontSize="14" FontWeight="Bold" TabIndex="1" />

                                            <RadioButton  Content="همه" GroupName="TransactionType" x:Name="ALLRadioButtonInstantPayment" Width="60"  Checked="RadioButtonInstantPayment_Checked" Margin="5"/>
                                            <RadioButton  Content="دارای موجودی" GroupName="TransactionType" x:Name="DebtorRadioButtonInstantPayment" Width="115" Checked="RadioButtonInstantPayment_Checked" Margin="5"/>
                                            <RadioButton   Content="موجودی منفی" GroupName="TransactionType" x:Name="CreditorRadioButtonInstantPayment" Width="115" Checked="RadioButtonInstantPayment_Checked" Margin="5"/>
                                        </StackPanel>
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,6,0,0">
                                        </StackPanel>
                                    </StackPanel>
                                    <!--<Button x:Name="btnfinchekpaymentlistexcel" Margin="7,0,0,0" Background="#FF006CB9" BorderBrush="#FF969696" Foreground="White" FontFamily="Estedad" FontSize="14.667" FontWeight="Light" Style="{DynamicResource ButtonStyle1}" Cursor="Hand" Grid.Column="3" VerticalAlignment="Center" Height="30" IsTabStop="False"  Width="80" HorizontalAlignment="Right" DockPanel.Dock="Bottom">
                         <TextBlock TextAlignment="Center" FontSize="12" FontWeight="Medium" Text="خروجی اکسل"/>
                     </Button>-->
                                <Button x:Name="btnInstantPaymentDataGridExcel" 
                                          Margin="0,0,0,0" 
                                          Background="white"                                                           
                                          Style="{DynamicResource ButtonStyle1}" 
                                          Cursor="Hand" 
                                          Grid.Column="3" 
                                          VerticalAlignment="Center" 
                                          Height="90" 
                                          IsTabStop="False" 
                                          BorderBrush="White"                                       
                                          Width="60" 
                                          HorizontalAlignment="Right" 
                                          Click="InstantPaymentDataGridExcel">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/excel-2.jpg" Width="40" Height="40"  />

                                    </StackPanel>
                                </Button>
                            </DockPanel>

                            </Border>
                        </StackPanel>


                        <!-- DataGrid برای نمایش داده‌ها -->
                        <DataGrid 
                         x:Name="InstantPaymentDataGrid" 
                         Margin="5,90,5,0" 
                         IsReadOnly="True" 
                         FlowDirection="RightToLeft"
                         RowHeight="42" 
                         FontSize="16" 
                         AutoGenerateColumns="False"
                              FontFamily="Estedad"
                              MouseDoubleClick="DataGrid_MouseDoubleClick">

                            <DataGrid.Columns>
                            <DataGridTextColumn Header="ردیف" Binding="{Binding RowNumber}" />

                            <DataGridTextColumn Header="گروه تنخواه" Binding="{Binding TafziliGroupName}" />
                                <DataGridTextColumn Header="عنوان تنخواه" Binding="{Binding TafziliName}" />
                                <DataGridTextColumn Header="بدهکار اول دوره" Binding="{Binding FirstTotalDebtorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بستانکار اول دوره" Binding="{Binding FirstTotalCreditorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بدهکار طی دوره" Binding="{Binding TotalDebtorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بستانکار طی دوره" Binding="{Binding TotalCreditorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="ماهیت" Binding="{Binding NatureFinalBalance, Converter={StaticResource NatureFinalBalanceConverter}}">
                                    <DataGridTextColumn.CellStyle>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <!-- رنگ قرمز برای بدهکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="1">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Red" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ سبز برای بستانکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="2">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Green" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ پیش‌فرض برای بی حساب -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="0">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Black" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGridTextColumn.CellStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="مانده نهایی" Binding="{Binding Finalbalance, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </TabItem>

                <TabItem x:Name="CostTab" Header="هزینه‌ها" FontFamily="Estedad" FontSize="17" FontWeight="Bold" Height="50">
                    <Grid Background="White">
                        <StackPanel Margin="5"  FlowDirection="RightToLeft">
                            <!-- قرار دادن ComboBox داخل یک کادر (با استفاده از Border) -->
                            <Border BorderBrush="Gray" BorderThickness="3"  CornerRadius="7" Height="80" RenderTransformOrigin="0.882,0.56">
                                <DockPanel Margin="10,10,10,20">
                                    <StackPanel>
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left">
                                            <TextBlock x:Name="txtlabelProjectCostsearchby" Height="32" TextWrapping="Wrap" Width="50" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="پروژه"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchProjectInCost"  SelectionChanged="SearchInCost_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>

                                            <TextBlock x:Name="txtlabelCostsearchby" Height="32" TextWrapping="Wrap" Width="95" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="گروه هزینه ها"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchInCost"  SelectionChanged="SearchInCost_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>
                                            <TextBlock x:Name="txtlabelCostsearchby2"  Height="32" TextWrapping="Wrap" Width="100" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run Text="عنوان هزینه: "/></TextBlock>
                                            <TextBox x:Name="txtfilterdataCost" TextChanged="TxtfilterdataCost_TextChanged" SelectionBrush="#FFFF9900" BorderBrush="#FFC6C7C8" Cursor="IBeam" Style="{DynamicResource TextBoxStyle1}" Padding="3,3,0,0" Grid.Column="1" HorizontalAlignment="Left" Width="192" Grid.Row="2" Margin="0" Height="30" VerticalAlignment="Center" FontFamily="Estedad" FontSize="14" FontWeight="Bold" TabIndex="1" />

                                            <Label x:Name="TotalCostLabel" 
    
                                            Height="30"                                                                                           
                                            Margin="80,0,0,0" 
                                            FontFamily="Estedad" 
                                            FontSize="13.333" 
                                            FontWeight="Medium"                                               
                                            Content="مجموع هزینه‌ها: 0">
                                            </Label>

                                            <!--<RadioButton  Content="همه" GroupName="TransactionType" x:Name="ALLRadioButtonCost" Width="60"  Checked="RadioButtonCost_Checked" Margin="5"/>
                                            <RadioButton  Content="دارای موجودی" GroupName="TransactionType" x:Name="DebtorRadioButtonCost" Width="115" Checked="RadioButtonCost_Checked" Margin="5"/>
                                            <RadioButton   Content="موجودی منفی" GroupName="TransactionType" x:Name="CreditorRadioButtonCost" Width="115" Checked="RadioButtonCost_Checked" Margin="5"/>-->
                                        </StackPanel>
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,6,0,0">
                                        </StackPanel>
                                    </StackPanel>
                                <Button x:Name="btnCostDataGridExcel" 
                                       Margin="0,0,0,0" 
                                       Background="white"                                                           
                                       Style="{DynamicResource ButtonStyle1}" 
                                       Cursor="Hand" 
                                       Grid.Column="3" 
                                       VerticalAlignment="Center" 
                                       Height="90" 
                                       IsTabStop="False" 
                                       BorderBrush="White"                                       
                                       Width="60" 
                                       HorizontalAlignment="Right" 
                                       Click="CostDataGridExcel">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/excel-2.jpg" Width="40" Height="40"  />

                                    </StackPanel>
                                </Button>
                            </DockPanel>

                            </Border>
                        </StackPanel>



                        <DataGrid x:Name="CostDataGrid" 
                          Margin="5,90,5,0" 
                         IsReadOnly="True" 
                         FlowDirection="RightToLeft"
                         RowHeight="42" 
                         FontSize="16" 
                         AutoGenerateColumns="False"
                         FontFamily="Estedad"
                                    MouseDoubleClick="DataGrid_MouseDoubleClick">
                            <DataGrid.Columns>
                            <DataGridTextColumn Header="ردیف" Binding="{Binding RowNumber}" />
                            <!--<DataGridTextColumn Header="گروه هزینه" Binding="{Binding TafziliGroupName}" />-->
                                <DataGridTextColumn Header="عنوان هزینه" Binding="{Binding TafziliName}" />
                                <DataGridTextColumn Header="بدهکار اول دوره" Binding="{Binding FirstTotalDebtorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بستانکار اول دوره" Binding="{Binding FirstTotalCreditorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بدهکار طی دوره" Binding="{Binding TotalDebtorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بستانکار طی دوره" Binding="{Binding TotalCreditorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="ماهیت" Binding="{Binding NatureFinalBalance, Converter={StaticResource NatureFinalBalanceConverter}}">
                                    <DataGridTextColumn.CellStyle>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <!-- رنگ قرمز برای بدهکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="1">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Red" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ سبز برای بستانکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="2">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Green" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ پیش‌فرض برای بی حساب -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="0">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Black" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGridTextColumn.CellStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="مانده نهایی" Binding="{Binding Finalbalance, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                            </DataGrid.Columns>
                        </DataGrid>

                    </Grid>




                </TabItem>

                <TabItem x:Name="IncomTab" Header="درآمدها" FontFamily="Estedad" FontSize="17" FontWeight="Bold" Height="50">
                    <Grid Background="White">
                        <StackPanel Margin="5"  FlowDirection="RightToLeft">
                            <!-- قرار دادن ComboBox داخل یک کادر (با استفاده از Border) -->
                            <Border BorderBrush="Gray" BorderThickness="3"  CornerRadius="7" Height="80" RenderTransformOrigin="0.882,0.56">
                                <DockPanel Margin="10,10,10,20">
                                    <StackPanel>
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left">
                                            <TextBlock x:Name="txtlabelIncomsearchby" Height="32" TextWrapping="Wrap" Width="95" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run Text="F3"/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="گروه درآمد ها"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchInIncom"  SelectionChanged="SearchInIncom_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>
                                            <TextBlock x:Name="txtlabelIncomsearchby2"  Height="32" TextWrapping="Wrap" Width="100" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run Text=" F4 عنوان درآمد: "/></TextBlock>
                                            <TextBox x:Name="txtfilterdataIncom" TextChanged="TxtfilterdataIncom_TextChanged" SelectionBrush="#FFFF9900" BorderBrush="#FFC6C7C8" Cursor="IBeam" Style="{DynamicResource TextBoxStyle1}" Padding="3,3,0,0" Grid.Column="1" HorizontalAlignment="Left" Width="192" Grid.Row="2" Margin="0" Height="30" VerticalAlignment="Center" FontFamily="Estedad" FontSize="14" FontWeight="Bold" TabIndex="1" />

                                            <!--<RadioButton  Content="همه" GroupName="TransactionType" x:Name="ALLRadioButtonCost" Width="60"  Checked="RadioButtonCost_Checked" Margin="5"/>
                             <RadioButton  Content="دارای موجودی" GroupName="TransactionType" x:Name="DebtorRadioButtonCost" Width="115" Checked="RadioButtonCost_Checked" Margin="5"/>
                             <RadioButton   Content="موجودی منفی" GroupName="TransactionType" x:Name="CreditorRadioButtonCost" Width="115" Checked="RadioButtonCost_Checked" Margin="5"/>-->
                                        </StackPanel>
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,6,0,0">
                                        </StackPanel>
                                    </StackPanel>
                                <Button x:Name="btnIncomDataGridExcel" 
                                       Margin="0,0,0,0" 
                                       Background="white"                                                           
                                       Style="{DynamicResource ButtonStyle1}" 
                                       Cursor="Hand" 
                                       Grid.Column="3" 
                                       VerticalAlignment="Center" 
                                       Height="90" 
                                       IsTabStop="False" 
                                       BorderBrush="White"                                       
                                       Width="60" 
                                       HorizontalAlignment="Right" 
                                       Click="IncomDataGridExcel">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/excel-2.jpg" Width="40" Height="40"  />

                                    </StackPanel>
                                </Button>
                            </DockPanel>

                            </Border>
                        </StackPanel>



                        <DataGrid x:Name="IncomDataGrid" 
                           Margin="5,90,5,0" 
                          IsReadOnly="True" 
                          FlowDirection="RightToLeft"
                          RowHeight="42" 
                          FontSize="16" 
                          AutoGenerateColumns="False"
                          FontFamily="Estedad"
                          MouseDoubleClick="DataGrid_MouseDoubleClick">
                            <DataGrid.Columns>
                            <DataGridTextColumn Header="ردیف" Binding="{Binding RowNumber}" />
                            <DataGridTextColumn Header="گروه درآمد" Binding="{Binding TafziliGroupName}" />
                                <DataGridTextColumn Header="عنوان درآمد" Binding="{Binding TafziliName}" />
                                <DataGridTextColumn Header="بدهکار اول دوره" Binding="{Binding FirstTotalDebtorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بستانکار اول دوره" Binding="{Binding FirstTotalCreditorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بدهکار طی دوره" Binding="{Binding TotalDebtorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بستانکار طی دوره" Binding="{Binding TotalCreditorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="ماهیت" Binding="{Binding NatureFinalBalance, Converter={StaticResource NatureFinalBalanceConverter}}">
                                    <DataGridTextColumn.CellStyle>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <!-- رنگ قرمز برای بدهکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="1">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Red" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ سبز برای بستانکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="2">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Green" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ پیش‌فرض برای بی حساب -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="0">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Black" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGridTextColumn.CellStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="مانده نهایی" Binding="{Binding Finalbalance, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                            </DataGrid.Columns>
                        </DataGrid>

                    </Grid>




                </TabItem>

                <TabItem x:Name="costListDetailsTab" Header="گردش هزینه‌" FontFamily="Estedad" FontSize="17" FontWeight="Bold" Height="50">
                    <Grid Background="White">
                        <StackPanel Margin="5"  FlowDirection="RightToLeft">
                            <!-- قرار دادن ComboBox داخل یک کادر (با استفاده از Border) -->
                            <Border BorderBrush="Gray" BorderThickness="3"  CornerRadius="7" Height="150" RenderTransformOrigin="0.882,0.56">
                                <DockPanel Margin="10,10,10,20">
                                    <StackPanel>
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left">
                                            
                                            <!--<TextBlock x:Name="TextSearchDateFromIncostListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="از تاریخ"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <DatePicker x:Name="btnaccsanadaccdate" Height="30"  Margin="5,0,15,0"  VerticalAlignment="Center" Width="192" Background="#FFFF9900" BorderBrush="#FFFF9900" Foreground="Black" HorizontalAlignment="Left"  VerticalContentAlignment="Stretch" Cursor="Hand" Focusable="False" Grid.Column="2"/>
                                           

                                            <TextBlock x:Name="TextBlockSearchDateToIncostListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="تا تاریخ "/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <DatePicker x:Name="DateSearchDateToIncostListDetails" Height="30" Margin="0,0,5,0" VerticalAlignment="Center" Width="192" Background="#FFFF9900" BorderBrush="#FFFF9900" Foreground="Black" HorizontalAlignment="Left"  VerticalContentAlignment="Stretch" Cursor="Hand" Focusable="False" Grid.Column="2"/>-->
                                           

                                            <TextBlock x:Name="TextSearchProjectIncostListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="پروژه"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchProjectIncostListDetails"  SelectionChanged="SearchInCostListDetails_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>

                                            <!-- اضافه کردن لیبل برای نمایش مجموع هزینه‌ها -->
                                            <Label x:Name="TotalCostDetailsLabel" 
                                               
                                               Height="30"                                                                                           
                                               Margin="80,0,0,0" 
                                               FontFamily="Estedad" 
                                               FontSize="13.333" 
                                               FontWeight="Medium"                                               
                                               Content="مجموع هزینه‌ها: 0">
                                            </Label>

                                            <!--<Button x:Name="CostListDetails" Click="SearchInCostListDetails_SelectionChanged" Margin="80,0,0,0" Background="#FF006CB9" BorderBrush="#FF969696" Foreground="White" FontFamily="Estedad" FontSize="14.667" FontWeight="Light" Style="{DynamicResource ButtonStyle1}" Cursor="Hand" Grid.Column="3" VerticalAlignment="Center" Height="30" IsTabStop="False"  Width="100" HorizontalAlignment="Right">
                                                <TextBlock TextAlignment="Center" FontSize="15" FontWeight="Medium"><Run Text="نمایش گردش"/></TextBlock>
                                            </Button>-->




                                            <!--<RadioButton  Content="همه" GroupName="TransactionType" x:Name="ALLRadioButtonCost" Width="60"  Checked="RadioButtonCost_Checked" Margin="5"/>
                                            <RadioButton  Content="دارای موجودی" GroupName="TransactionType" x:Name="DebtorRadioButtonCost" Width="115" Checked="RadioButtonCost_Checked" Margin="5"/>
                                            <RadioButton   Content="موجودی منفی" GroupName="TransactionType" x:Name="CreditorRadioButtonCost" Width="115" Checked="RadioButtonCost_Checked" Margin="5"/>-->
                                        </StackPanel>
                                        
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,6,0,0">

                                            <TextBlock x:Name="TextSearchIncostListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="هزینه"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchIncostListDetails"  SelectionChanged="SearchInCostListDetails_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>

                                            <TextBlock x:Name="TextSearchIncostSenter1ListDetails" Height="32" TextWrapping="Wrap" Width="75" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="مرکز هزینه 1"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchIncostSenter1ListDetails"  SelectionChanged="SearchInCostListDetails_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>

                                            <TextBlock x:Name="TextSearchIncostSenter2ListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="مرکز هزینه 2"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchIncostSenter2ListDetails"  SelectionChanged="SearchInCostListDetails_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>
                                        </StackPanel>

                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,6,0,0">

                                            <TextBlock x:Name="TextSearchInSuppliercostListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="تامین کننده"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchInSuppliercostListDetails"  SelectionChanged="SearchInCostListDetails_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>

                                            <TextBlock x:Name="TextSearchInMaterialGroupListDetails" Height="32" TextWrapping="Wrap" Width="75" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="گروه کالا"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchIncostMaterialGroupListDetails"  SelectionChanged="SearchInCostListDetails_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>

                                            <TextBlock x:Name="TextSearchInMaterialListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="کالا"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchInMaterialListDetails"  SelectionChanged="SearchInCostListDetails_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>

                                          
                                        </StackPanel>
                                    </StackPanel>
                                <Button x:Name="btncostListDetailsGridExcel" 
                                      Margin="0,0,0,0" 
                                      Background="white"                                                           
                                      Style="{DynamicResource ButtonStyle1}" 
                                      Cursor="Hand" 
                                      Grid.Column="3" 
                                      VerticalAlignment="Center" 
                                      Height="90" 
                                      IsTabStop="False" 
                                      BorderBrush="White"                                       
                                      Width="60" 
                                      HorizontalAlignment="Right" 
                                      Click="costListDetailsGridExcel">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/excel-2.jpg" Width="40" Height="40"  />

                                    </StackPanel>
                                </Button>
                            </DockPanel>

                            </Border>
                        </StackPanel>


                      
                        <DataGrid x:Name="costListDetailsGrid" 
                              Margin="5,160,5,0" 
                             IsReadOnly="True" 
                             FlowDirection="RightToLeft"
                             RowHeight="42" 
                             FontSize="16" 
                             AutoGenerateColumns="False"
                             FontFamily="Estedad">
                            <DataGrid.Columns>
                            <DataGridTextColumn Header="ردیف" Binding="{Binding RowNumber}" />
                            <DataGridTextColumn Header="تاریخ" Binding="{Binding CostListRowDate, Converter={StaticResource PersianDateConverter}}" />
                                <DataGridTextColumn Header="پروژه" Binding="{Binding MoeinName}" />
                                <DataGridTextColumn Header="عنوان هزینه" Binding="{Binding TafziliName}" />
                                <DataGridTextColumn Header="مرکز هزینه 1" Binding="{Binding Tafzili2Name}"/>
                                <DataGridTextColumn Header="مرکز هزینه 2" Binding="{Binding Tafzili3Name}" />
                                <DataGridTextColumn Header="تامین کننده" Binding="{Binding SupplierTitle}" />
                                <DataGridTextColumn Header="مبلغ" Binding="{Binding CostListRowfinalValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="گروه کالا" Binding="{Binding MaterialGroupTitle}" />
                                <DataGridTextColumn Header="کالا" Binding="{Binding MaterialTitle}" />
                                <DataGridTextColumn Header="واحد کالا" Binding="{Binding MaterialUnitTitle}" />
                                <DataGridTextColumn Header="تعداد" Binding="{Binding AmountMaterial}" />
                                <DataGridTextColumn Header="قیمت" Binding="{Binding PriceMaterial, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                            </DataGrid.Columns>



                            </DataGrid>
                     
                    </Grid>




                </TabItem>

                <TabItem   Header="گردش حساب" x:Name="InvoiceTab"  FontFamily="Estedad" FontSize="17" FontWeight="Bold" Height="50">
                    <Grid Background="White">

                        <StackPanel Margin="5"  FlowDirection="RightToLeft">
                            <!-- قرار دادن ComboBox داخل یک کادر (با استفاده از Border) -->
                            <Border BorderBrush="Gray" BorderThickness="3"  CornerRadius="7" Height="80" RenderTransformOrigin="0.882,0.56">
                                <DockPanel Margin="10,10,10,20">
                                  
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left">

                                            <!--<TextBlock x:Name="TextSearchDateFromIncostListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="از تاریخ"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                           <DatePicker x:Name="btnaccsanadaccdate" Height="30"  Margin="5,0,15,0"  VerticalAlignment="Center" Width="192" Background="#FFFF9900" BorderBrush="#FFFF9900" Foreground="Black" HorizontalAlignment="Left"  VerticalContentAlignment="Stretch" Cursor="Hand" Focusable="False" Grid.Column="2"/>
                     

                                              <TextBlock x:Name="TextBlockSearchDateToIncostListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="تا تاریخ "/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                              <DatePicker x:Name="DateSearchDateToIncostListDetails" Height="30" Margin="0,0,5,0" VerticalAlignment="Center" Width="192" Background="#FFFF9900" BorderBrush="#FFFF9900" Foreground="Black" HorizontalAlignment="Left"  VerticalContentAlignment="Stretch" Cursor="Hand" Focusable="False" Grid.Column="2"/>-->


                                            <TextBlock x:Name="TextSearchInvoice" Height="32" TextWrapping="Wrap" Width="110" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="گردش حساب"/><Run FlowDirection="RightToLeft" Text=" :"/></TextBlock>
                                        <ComboBox x:Name="SearchInvoice"  SelectionChanged="SearchInInvice_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="250" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0,0,0,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>

                                            <!-- اضافه کردن لیبل برای نمایش مجموع هزینه‌ها --><!--
                                            <Label x:Name="TotalInvoiceLabel" 
                         
                                             Height="30"                                                                                           
                                             Margin="80,0,0,0" 
                                             FontFamily="Estedad" 
                                             FontSize="13.333" 
                                             FontWeight="Medium"                                               
                                             Content="مجموع هزینه‌ها: 0">
                                            </Label>-->

                                        </StackPanel>

                                <Button x:Name="btnExportToExcel" 
                                Margin="0,0,0,0" 
                                Background="white"                                                           
                                Style="{DynamicResource ButtonStyle1}" 
                                Cursor="Hand" 
                                Grid.Column="3" 
                                VerticalAlignment="Center" 
                                Height="90" 
                                IsTabStop="False" 
                                BorderBrush="White"                                       
                                Width="60" 
                                HorizontalAlignment="Right" 
                                Click="ExportToExcel_Click">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/excel-2.jpg" Width="40" Height="40"  />
                                      
                                    </StackPanel>
                                </Button>

                            </DockPanel>

                            </Border>
                        </StackPanel>
                        <DataGrid x:Name="accDocumentDetailsGrid" 
                                Margin="5,90,5,0" 
                              AutoGenerateColumns="False"
                              HorizontalAlignment="Stretch"
                              VerticalAlignment="Stretch" 
                              IsReadOnly="True"
                              FlowDirection="RightToLeft"
                              RowHeight="50"
                              FontSize="16"
                             >

                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ردیف" Binding="{Binding RowNumber}" />
                            <DataGridTextColumn Header="تاریخ" Binding="{Binding AccDocumentRowDate, Converter={StaticResource PersianDateConverter}}" />
                            <DataGridTemplateColumn Width="550" Header="شرح سند" >
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding AccDocumentRowDescription}" 
                                               TextWrapping="Wrap" 
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Stretch" FontSize="13" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="بدهکار" Binding="{Binding DebtorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="بستانکار" Binding="{Binding CreditorValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                
                                <DataGridTextColumn Header="ماهیت" Binding="{Binding NatureFinalBalance, Converter={StaticResource NatureFinalBalanceConverter}}">
                                    <DataGridTextColumn.CellStyle>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <!-- رنگ قرمز برای بدهکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="1">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Red" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ سبز برای بستانکار -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="2">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Green" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ پیش‌فرض برای بی حساب -->
                                                <DataTrigger Binding="{Binding NatureFinalBalance}" Value="0">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Black" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGridTextColumn.CellStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="مانده فعلی" Binding="{Binding Finalbalance, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                              
                        </DataGrid.Columns>


                        </DataGrid>
                    </Grid>
                </TabItem>

                <TabItem Header="چک‌ دریافتی"  x:Name="ReceiveChequeTab"  FontFamily="Estedad" FontSize="17" FontWeight="Bold" Height="50">
                    <Grid Background="White">
                        <StackPanel Margin="5"  FlowDirection="RightToLeft">
                            <!-- قرار دادن ComboBox داخل یک کادر (با استفاده از Border) -->
                            <Border BorderBrush="Gray" BorderThickness="3"  CornerRadius="7" Height="80" RenderTransformOrigin="0.882,0.56">
                                <DockPanel Margin="10,10,10,20">

                                    <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left">

                                        <!--<TextBlock x:Name="TextSearchDateFromIncostListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="از تاریخ"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                         <DatePicker x:Name="btnaccsanadaccdate" Height="30"  Margin="5,0,15,0"  VerticalAlignment="Center" Width="192" Background="#FFFF9900" BorderBrush="#FFFF9900" Foreground="Black" HorizontalAlignment="Left"  VerticalContentAlignment="Stretch" Cursor="Hand" Focusable="False" Grid.Column="2"/>
                     

                                        <TextBlock x:Name="TextBlockSearchDateToIncostListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="تا تاریخ "/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                        <DatePicker x:Name="DateSearchDateToIncostListDetails" Height="30" Margin="0,0,5,0" VerticalAlignment="Center" Width="192" Background="#FFFF9900" BorderBrush="#FFFF9900" Foreground="Black" HorizontalAlignment="Left"  VerticalContentAlignment="Stretch" Cursor="Hand" Focusable="False" Grid.Column="2"/>-->


                                        <TextBlock x:Name="TextSearchReceiveCheque" Height="32" TextWrapping="Wrap" Width="150" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="آخرین وضعیت چک ها"/><Run FlowDirection="RightToLeft" Text=" :"/></TextBlock>
                                        <ComboBox x:Name="SearchReceiveCheque"  SelectionChanged="SearchInReceiveCheque_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="200" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0,0,0,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            <ComboBoxItem Content="همه چک‌ها" Tag="0" />
                                            <ComboBoxItem Content=" چک‌های پاس نشده" Tag="1" />
                                            <ComboBoxItem Content=" چک‌های پاس شده" Tag="2" />
                                            <ComboBoxItem Content="چک‌های برگشت شده" Tag="3" />
                                        </ComboBox>

                                        <TextBlock x:Name="TextSearchProjectInReceiveCheque" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="30,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="پروژه"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                        <ComboBox x:Name="SearchProjectInReceiveCheque"  SelectionChanged="SearchInReceiveCheque_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                        </ComboBox>

                                        <TextBlock x:Name="TextSearchReceiveChequeNumberInReceiveCheque" Height="32" TextWrapping="Wrap" Width="75" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="5,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="شماره چک"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                        <TextBox x:Name="txtSearchReceiveChequeNumberInReceiveCheque" TextChanged="TxtSearchInReceiveCheque_TextChanged" SelectionBrush="#FFFF9900" BorderBrush="#FFC6C7C8" Cursor="IBeam" Style="{DynamicResource TextBoxStyle1}" Padding="0,3,0,0" Margin="0,0,15,0" Grid.Column="1" HorizontalAlignment="Left" Width="192" Grid.Row="2" Height="30" VerticalAlignment="Center" FontFamily="Estedad" FontSize="14" FontWeight="Bold" TabIndex="1" />


                                    </StackPanel>


                                <Button x:Name="btnreceiveChequeGridExcel" 
                                        Margin="0,0,0,0" 
                                        Background="white"                                                           
                                        Style="{DynamicResource ButtonStyle1}" 
                                        Cursor="Hand" 
                                        Grid.Column="3" 
                                        VerticalAlignment="Center" 
                                        Height="90" 
                                        IsTabStop="False" 
                                        BorderBrush="White"                                       
                                        Width="60" 
                                        HorizontalAlignment="Right" 
                                        Click="receiveChequeGridExcel">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/excel-2.jpg" Width="40" Height="40"  />

                                    </StackPanel>
                                </Button>
                            </DockPanel>

                            </Border>
                        </StackPanel>
                        <DataGrid x:Name="receiveChequeGrid" 
                                    Margin="5,90,5,0" 
                                    AutoGenerateColumns="False"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch" 
                                    IsReadOnly="True"
                                    FlowDirection="RightToLeft"
                                    RowHeight="50"
                                    FontSize="16">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ردیف" Binding="{Binding RowNumber}" />
                            <DataGridTextColumn Header="شماره چک " Binding="{Binding ReceiveChequeNumber}" />
                            <DataGridTextColumn Header="شماره صیادی" Binding="{Binding ReceiveChequeSayyadiNumber}" />
                            <DataGridTemplateColumn Width="250" Header="به بانک">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding BankTitle}" 
                                               TextWrapping="Wrap" 
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Stretch" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            
                            <DataGridTextColumn Header="پرداخت کننده" Binding="{Binding PayerTitle}" />
                            <DataGridTextColumn Header="قرارداد" Binding="{Binding ContractTitle}" />
                            <DataGridTextColumn Header=" تاریخ چک" Binding="{Binding ReceiveChequeDate, Converter={StaticResource PersianDateConverter}}" />
                            <DataGridTextColumn Header="آخرین وضعیت" Binding="{Binding ReceiveChequeLastState, Converter={StaticResource ChequeLastStateConverter}}">
                                    <DataGridTextColumn.CellStyle>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <!-- رنگ قرمز برای برگشت -->
                                                <DataTrigger Binding="{Binding ReceiveChequeLastState}" Value="3">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Red" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ سبز برای پاس شده -->
                                                <DataTrigger Binding="{Binding ReceiveChequeLastState}" Value="2">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Green" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ قرمز برای برگشت -->
                                                <DataTrigger Binding="{Binding ReceiveChequeLastState}" Value="4">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Blue" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ پیش‌فرض برای بی حساب -->
                                                <DataTrigger Binding="{Binding ReceiveChequeLastState}" Value="1">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Black" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGridTextColumn.CellStyle>
                                </DataGridTextColumn>
                            <DataGridTextColumn Header="مبلغ" Binding="{Binding ReceiveChequeValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                            <DataGridTextColumn Header="شرح چک" Binding="{Binding ReceiveChequeDescription}" />
                           
                        </DataGrid.Columns>



                        </DataGrid>
                    </Grid>
                </TabItem>

                <TabItem Header="چک‌ پرداختی"  x:Name="PaymentChequeTab"  FontFamily="Estedad" FontSize="17" FontWeight="Bold" Height="50">
                    <Grid Background="White">
                        <StackPanel Margin="5"  FlowDirection="RightToLeft">
                            <!-- قرار دادن ComboBox داخل یک کادر (با استفاده از Border) -->
                            <Border BorderBrush="Gray" BorderThickness="3"  CornerRadius="7" Height="80" RenderTransformOrigin="0.882,0.56">
                                <DockPanel Margin="10,10,10,20">

                                    <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left">

                                        <!--<TextBlock x:Name="TextSearchDateFromIncostListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="از تاریخ"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                         <DatePicker x:Name="btnaccsanadaccdate" Height="30"  Margin="5,0,15,0"  VerticalAlignment="Center" Width="192" Background="#FFFF9900" BorderBrush="#FFFF9900" Foreground="Black" HorizontalAlignment="Left"  VerticalContentAlignment="Stretch" Cursor="Hand" Focusable="False" Grid.Column="2"/>
     

                                        <TextBlock x:Name="TextBlockSearchDateToIncostListDetails" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="تا تاریخ "/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                        <DatePicker x:Name="DateSearchDateToIncostListDetails" Height="30" Margin="0,0,5,0" VerticalAlignment="Center" Width="192" Background="#FFFF9900" BorderBrush="#FFFF9900" Foreground="Black" HorizontalAlignment="Left"  VerticalContentAlignment="Stretch" Cursor="Hand" Focusable="False" Grid.Column="2"/>-->


                                        <TextBlock x:Name="TextSearchPaymentCheque" Height="32" TextWrapping="Wrap" Width="150" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="آخرین وضعیت چک ها"/><Run FlowDirection="RightToLeft" Text=" :"/></TextBlock>
                                        <ComboBox x:Name="SearchPaymentCheque"  SelectionChanged="SearchInPaymentCheque_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="200" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0,0,0,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            <ComboBoxItem Content="همه چک‌ها" Tag="0" />
                                            <ComboBoxItem Content=" چک‌های پاس نشده" Tag="1" />
                                            <ComboBoxItem Content=" چک‌های پاس شده" Tag="2" />
                                            <ComboBoxItem Content="چک‌های برگشت شده" Tag="3" />
                                        </ComboBox>

                                        <TextBlock x:Name="TextSearchProjectInPaymentCheque" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="30,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="پروژه"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                        <ComboBox x:Name="SearchProjectInPaymentCheque"  SelectionChanged="SearchInPaymentCheque_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                        </ComboBox>

                                        <TextBlock x:Name="TextSearchReceiveChequeNumberInPaymentCheque" Height="32" TextWrapping="Wrap" Width="75" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="5,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="شماره چک"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                        <TextBox x:Name="txtSearchPaymentChequeNumberInPaymentCheque" TextChanged="TxtSearchInPaymentCheque_TextChanged" SelectionBrush="#FFFF9900" BorderBrush="#FFC6C7C8" Cursor="IBeam" Style="{DynamicResource TextBoxStyle1}" Padding="0,3,0,0" Margin="0,0,15,0" Grid.Column="1" HorizontalAlignment="Left" Width="192" Grid.Row="2" Height="30" VerticalAlignment="Center" FontFamily="Estedad" FontSize="14" FontWeight="Bold" TabIndex="1" />


                                    </StackPanel>



                                <Button x:Name="btnpaymentChequeGridExcel" 
                                        Margin="0,0,0,0" 
                                        Background="white"                                                           
                                        Style="{DynamicResource ButtonStyle1}" 
                                        Cursor="Hand" 
                                        Grid.Column="3" 
                                        VerticalAlignment="Center" 
                                        Height="90" 
                                        IsTabStop="False" 
                                        BorderBrush="White"                                       
                                        Width="60" 
                                        HorizontalAlignment="Right" 
                                        Click="paymentChequeGridExcel">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/excel-2.jpg" Width="40" Height="40"  />

                                    </StackPanel>
                                </Button>
                            </DockPanel>

                            </Border>
                        </StackPanel>
                        <DataGrid x:Name="paymentChequeGrid" 
                            Margin="5,90,5,0" 
                            AutoGenerateColumns="False"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch" 
                            IsReadOnly="True"
                            FlowDirection="RightToLeft"
                            RowHeight="50"
                            FontSize="16">
                            <DataGrid.Columns>
                            <DataGridTextColumn Header="ردیف" Binding="{Binding RowNumber}" />
                            <DataGridTextColumn Header="شماره چک " Binding="{Binding PaymentChequeNumber}" />
                                <DataGridTextColumn Header="شماره صیادی" Binding="{Binding PaymentChequeSayyadiNumber}" />
                            <DataGridTemplateColumn Width="250" Header="از بانک">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding BankTitle}" 
                                                TextWrapping="Wrap" 
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Stretch" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                          
                                <DataGridTextColumn Header="دریافت کننده" Binding="{Binding ReciverTitle}" />
                                <DataGridTextColumn Header="قرارداد" Binding="{Binding ContractTitle}" />
                                <DataGridTextColumn Header=" تاریخ چک" Binding="{Binding PaymentChequeDate, Converter={StaticResource PersianDateConverter}}" />
                                <DataGridTextColumn Header="آخرین وضعیت" Binding="{Binding PaymentChequeLastState, Converter={StaticResource ChequeLastStateConverter}}">
                                    <DataGridTextColumn.CellStyle>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <!-- رنگ قرمز برای برگشت -->
                                                <DataTrigger Binding="{Binding ReceiveChequeLastState}" Value="3">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Red" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ سبز برای پاس شده -->
                                                <DataTrigger Binding="{Binding ReceiveChequeLastState}" Value="2">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Green" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ قرمز برای برگشت -->
                                                <DataTrigger Binding="{Binding ReceiveChequeLastState}" Value="4">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Blue" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>

                                                <!-- رنگ پیش‌فرض برای بی حساب -->
                                                <DataTrigger Binding="{Binding ReceiveChequeLastState}" Value="1">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)" To="Black" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGridTextColumn.CellStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="مبلغ" Binding="{Binding PaymentChequeValue, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="شرح چک" Binding="{Binding PaymentChequeDescription}" />

                            </DataGrid.Columns>



                        </DataGrid>
                    </Grid>
                </TabItem>

                <TabItem Header="مصالح مصرفی"  x:Name="MaterialCirculationTab" FontFamily="Estedad" FontSize="17" FontWeight="Bold" Height="50">
                    <Grid Background="White">
                        <StackPanel Margin="5"  FlowDirection="RightToLeft">
                            <!-- قرار دادن ComboBox داخل یک کادر (با استفاده از Border) -->
                            <Border BorderBrush="Gray" BorderThickness="3"  CornerRadius="7" Height="110" RenderTransformOrigin="0.882,0.56">
                                <DockPanel Margin="10,10,10,20">

                                    <StackPanel >
                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left">

                                            <TextBlock x:Name="TextSearchProjectInMaterialCirculation" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="پروژه"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchProjectIncostMaterialCirculation"  SelectionChanged="SearchInMaterialCirculation_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>

                                            <TextBlock x:Name="TextSearchInSupplierMaterialCirculation" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="تامین کننده"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchInSupplierMaterialCirculation"  SelectionChanged="SearchInMaterialCirculation_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>



                                        </StackPanel>



                                        <StackPanel FlowDirection="RightToLeft" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,6,0,0">

                                            <TextBlock x:Name="TextSearchInMaterialGroupMaterialCirculation" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="گروه کالا"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchIncostMaterialGroupMaterialCirculation"  SelectionChanged="SearchInMaterialCirculation_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>

                                            <TextBlock x:Name="TextSearchInMaterialCirculation" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="کالا"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchInMaterialCirculation"  SelectionChanged="SearchInMaterialCirculation_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>
                                            
                                            <TextBlock x:Name="TextSearchInStoreMaterialCirculation" Height="32" TextWrapping="Wrap" Width="80" FlowDirection="RightToLeft" Foreground="#FF002566" FontFamily="Estedad" FontSize="13.333" FontWeight="Medium" VerticalAlignment="Center" Padding="0,7,0,0" HorizontalAlignment="Left" Margin="0"><Run/><Run Text=" "/><Run FlowDirection="RightToLeft" /><Span><Run Text=" "/></Span><Run FlowDirection="RightToLeft" Text="انبار"/><Run FlowDirection="RightToLeft" Text=":"/></TextBlock>
                                            <ComboBox x:Name="SearchInStoreMaterialCirculation"  SelectionChanged="SearchInMaterialCirculation_SelectionChanged" Grid.Column="1" Grid.Row="4" Height="30" Width="192" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,15,0" FlowDirection="RightToLeft" BorderBrush="#FFC6C7C8" FontFamily="Estedad" FontSize="13.333" Cursor="Hand" TabIndex="2"  VerticalContentAlignment="Center">
                                            </ComboBox>
                                        </StackPanel>



                                    </StackPanel>

                                <Button x:Name="btnmaterialCirculationGridExcel" 
                                       Margin="0,0,0,0" 
                                       Background="white"                                                           
                                       Style="{DynamicResource ButtonStyle1}" 
                                       Cursor="Hand" 
                                       Grid.Column="3" 
                                       VerticalAlignment="Center" 
                                       Height="90" 
                                       IsTabStop="False" 
                                       BorderBrush="White"                                       
                                       Width="60" 
                                       HorizontalAlignment="Right" 
                                       Click="materialCirculationGridExcel">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/excel-2.jpg" Width="40" Height="40"  />

                                    </StackPanel>
                                </Button>
                            </DockPanel>

                            </Border>
                        </StackPanel>
                        <DataGrid x:Name="materialCirculationGrid" 
                                Margin="5,120,5,0" 
                               IsReadOnly="True" 
                               FlowDirection="RightToLeft"
                               RowHeight="42" 
                               FontSize="16" 
                               AutoGenerateColumns="False"
                               FontFamily="Estedad">
                            <DataGrid.Columns>
                            <DataGridTextColumn Header="ردیف" Binding="{Binding RowNumber}" />
                            <DataGridTextColumn Header="تاریخ" Binding="{Binding MaterialCirculationRowDate, Converter={StaticResource PersianDateConverter}}" />
                                <DataGridTextColumn Header="پروژه" Binding="{Binding ContractTitle}" />
                                <DataGridTextColumn Header="تامین کننده" Binding="{Binding SupplierTitle}" />
                                <DataGridTextColumn Header="انبار" Binding="{Binding StoreTitle}" />
                                <DataGridTextColumn Header="گروه کالا" Binding="{Binding MaterialGroupTitle}" />
                                <DataGridTextColumn Header="کالا" Binding="{Binding MaterialTitle}" />
                                <DataGridTextColumn Header="واحد کالا" Binding="{Binding MaterialUnitTitle}" />
                                <DataGridTextColumn Header="تعداد ورودی" Binding="{Binding AmountMaterialEntered}" />
                                <DataGridTextColumn Header=" قیمت ورودی" Binding="{Binding PriceMaterialEntered, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                                <DataGridTextColumn Header="تعداد خروجی" Binding="{Binding AmountMaterialOutput}" />
                                <DataGridTextColumn Header=" قیمت خروجی" Binding="{Binding PriceMaterialOutput, Converter={StaticResource NumberToThousandsSeparatorConverter}}" />
                            </DataGrid.Columns>



                        </DataGrid>
                    </Grid>
                </TabItem>
            </TabControl>
        <!--</ScrollViewer>-->

        <!-- StackPanel برای دکمه‌ها در ستون دوم (4% فضای فرم) -->
        <StackPanel Grid.Column="1" Background="#0E3756" Margin="10,0,0,0">
            <!-- دکمه‌ها -->
            <Button Height="70" Width="70" Margin="0,10" HorizontalAlignment="Center" VerticalAlignment="Center" Background="WhiteSmoke" BorderBrush="Transparent" >
                <Grid>

                    <Ellipse  StrokeThickness="2" Width="45" Height="45" />

                    <!-- تصویر داخل کادر -->
                    <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/icon.png" 
               Width="35"  HorizontalAlignment="Center" VerticalAlignment="Center" Stretch="Uniform" />
                </Grid>
            </Button>

            <StackPanel  Background="#0E3756" VerticalAlignment="Stretch">
                <!-- دکمه‌ها -->
                <Button  Height="50" Background="#0E3756" BorderBrush="#0E3756" Margin="0,10" HorizontalAlignment="Stretch" FontFamily="{StaticResource GandomFont}" FontSize="16" Click="OnButtonAppClick">
                    <Button.ToolTip>
                        <ToolTip FontFamily="Estedad" FontSize="12" FontWeight="Bold" Content="ورود به نرم‌ افزار ابنیه سافت"/>
                    </Button.ToolTip>
                    <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/app.png" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,0,0,0" Width="45"/>
                </Button>

                <!-- دکمه‌ها -->
                <Button  Height="50" Background="#0E3756" BorderBrush="#0E3756" Margin="0,10" HorizontalAlignment="Stretch" FontFamily="{StaticResource GandomFont}" FontSize="16" Click="OnButtonSiteClick">
                    <Button.ToolTip>
                        <ToolTip FontFamily="Estedad" FontSize="12" FontWeight="Bold" Content="ورود به سایت ابنیه سافت"/>
                    </Button.ToolTip>
                    <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/site.png" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,0,0,0" Width="45"/>
                </Button>

                <!-- دکمه‌ها -->
                <Button  Height="50" Background="#0E3756" BorderBrush="#0E3756"  Margin="0,10" HorizontalAlignment="Stretch" FontFamily="{StaticResource GandomFont}" FontSize="16"  Click="OnButtonWebinarClick">
                    <Button.ToolTip>
                        <ToolTip FontFamily="Estedad" FontSize="12" FontWeight="Bold" Content="وبینار"/>
                    </Button.ToolTip>
                    <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/vebinar.png" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,0,0,0" Width="45"/>
                </Button>

                <!-- دکمه‌ها -->
                <Button  Height="50" Background="#0E3756" BorderBrush="#0E3756"  Margin="0,10" HorizontalAlignment="Stretch" FontFamily="{StaticResource GandomFont}" FontSize="16">
                  
                    <Image Source="file:///D:/AbnieSoftACC/AbnieSoftACC/AbnieSoftDesktop/AbnieSoftDesktop/WindowsApp/img/education.png" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,0,0,0" Width="45"/>
                </Button>

               
            </StackPanel>
            


           

        </StackPanel>


    </Grid>
    <!-- فوتر جدید با ارتفاع کمتر و چسبیده به کف -->
    <!--
    <DockPanel VerticalAlignment="Bottom" Background="#2C3E50" Height="40" Margin="10" DockPanel.Dock="Bottom">
        <TextBlock Text="تمامی حقوق محفوظ است &copy; 2024" 
                 Foreground="White" 
                 FontFamily="{StaticResource GandomFont}" 
                 FontSize="12" 
                 VerticalAlignment="Center" 
                 HorizontalAlignment="Center"/>
    </DockPanel>-->
</Window>
